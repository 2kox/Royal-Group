<script>
    const cloudName = "dyetbyoy3"; // اسم الحساب في Cloudinary
    const uploadPreset = "Royal Group"; // إعدادات الرفع

    const uploadWidget = cloudinary.createUploadWidget(
        {
            cloudName: cloudName,
            uploadPreset: uploadPreset,
        },
        async (error, result) => {
            if (!error && result && result.event === "success") {
                const imageUrl = result.info.secure_url;
                console.log("رابط الصورة:", imageUrl);

                // إرسال رابط الصورة إلى الخادم الخلفي
                await fetch("http://localhost:3000/save-image", { // خادم الخلفية
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({
                        url: imageUrl,
                        comment: "تعليق الصورة" // يمكن تخصيص هذا
                    })
                });

                alert("تم رفع الصورة وحفظها بنجاح!");
            }
        }
    );

    document.getElementById("upload_widget").addEventListener("click", () => {
        uploadWidget.open();
    });
</script>
